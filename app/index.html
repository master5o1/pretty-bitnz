<!doctype html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">    
    <link rel="stylesheet" href="styles/styles.css">        
    <!-- endbuild -->
  </head>  
    <body ng-app="prettyBitnzApp">

    <div id="layout" ng-controller="MasterCtrl" ng-class=" side_bar_toggled ? 'active' : ''">      
      <!-- Menu toggle -->
      <a href="#menu" id="menuLink" class="menu-link" ng-class=" side_bar_toggled ? 'active' : ''" ng-click="show_side_bar()">
          <!-- Hamburger icon -->
          <span></span>
      </a>

      <div id="menu" ng-class=" side_bar_toggled ? 'active' : ''">
          <div class="pure-menu pure-menu-open">
              <a class="pure-menu-heading" href="#">Pretty BitNZ</a>

              <ul>
                  <li><a href="#">Home</a></li>
                  <li><a href="#trade">Trade</a></li>
                  <li><a href="#history">History</a></li>
                  <li><a href="#settings">Settings</a></li>
                  <li><a href="#help">Help</a></li>
                  <li><a href="#about">About</a></li>
              </ul>
          </div>
      </div>

      <div id="ticker" ng-controller="TickerCtrl">
        <span>Last Price: <strong>{{ ticker.last | currency:'$' }}</strong></span>
        <span>Today's Low: <strong>{{ ticker.low | currency:'$' }}</strong></span>
        <span>Today's High: <strong>{{ ticker.high | currency:'$' }}</strong></span>
        <span>Current Bid: <strong>{{ ticker.bid | currency:'$' }}</strong></span>
        <span>Current Ask: <strong>{{ ticker.ask | currency:'$' }}</strong></span>
        <span>Volume: <strong>{{ ticker.volume | number:8 }}</strong></span>
        <span>
          <span class="pure-button button-xsmall" ng-click="Reload()">reload</span>
        </span>
      </div>

      <div id="main">
        <div class="header">
          <h1>Pretty BitNZ</h1>
          <h2>A nicer interface for our favourite New Zealand exchange</h2>
        </div>
        <div ng-view=""></div>        
      </div>
    </div>

    <!---- VIEWS -->
    <script id="main.html" type="text/ng-template">
      <div class="content" ng-if="last_price">
          <h2 class="content-subhead">
            Last Price: <strong>{{ last_price  | currency:'$' }}</strong> | 
            Bid: <strong>{{ bid_price  | currency:'$' }}</strong> | 
            Ask: <strong>{{ ask_price  | currency:'$' }}</strong>
          </h2>
          <hr />
          <form class="pure-form pure-form-aligned order-form">
            <ul class="pure-paginator">            
                <li><a class="pure-button" ng-class="active_tab == 'buy' ? 'pure-button-active button-secondary' : ''" ng-click="switch_tab('buy')">New Buy Order</a></li>
                <li><a class="pure-button"  ng-class="active_tab == 'sell' ? 'pure-button-active button-secondary' : ''" ng-click="switch_tab('sell')">New Sell Order</a></li>            
            </ul>
            <fieldset ng-show="active_tab == 'buy'">            
                <div class="pure-control-group">
                    <label for="name">Buy BTC Amount</label>
                    <input required ng-model="new_order.btc_amount" type="number" step="0.0000000001" placeholder="Eg. 0.1">
                    <a class="pure-button button-small" ng-click="use_remaining()">Use Remaining NZD</a>                
                </div>

                <div class="pure-control-group">
                    <label for="name">At NZD Rate</label>
                    <input required ng-model="new_order.btc_rate" type="number" step="0.01" placeholder="Eg. $683.23">
                    <a class="pure-button button-small" ng-click="use_last()">Last Price</a>
                    <a class="pure-button button-small" ng-click="use_ask()">Ask</a>
                    <a class="pure-button button-small" ng-click="use_bid()">Bid</a>
                </div>            
                <div>
                  <strong class='pull-left'>Total {{ new_order.btc_amount * new_order.btc_rate | currency:'$'}}</strong>              
                    <button type="submit" class="pull-right pure-button pure-button-primary" ng-click="create_order()">Buy BTC</button>
                </div>
            </fieldset>

            <fieldset ng-show="active_tab == 'sell'">            
                <div class="pure-control-group">
                    <label for="name">Sell BTC Amount</label>
                    <input required ng-model="new_order.btc_amount" type="number" step="0.01" placeholder="Eg. 0.1">
                    <a class="pure-button button-small" ng-click="use_remaining()">Use Remaining BTC</a>                
                </div>

                <div class="pure-control-group">
                    <label for="name">At NZD Rate</label>
                    <input required ng-model="new_order.btc_rate" type="number" step="0.1" placeholder="Eg. $683.23">
                    <a class="pure-button button-small" ng-click="use_last()">Last Price</a>
                    <a class="pure-button button-small" ng-click="use_ask()">Ask</a>
                    <a class="pure-button button-small" ng-click="use_bid()">Bid</a>
                </div>            
                <div>
                    <strong class='pull-left'>Total {{ new_order.btc_amount * new_order.btc_rate | currency:'$'}}</strong>              
                    <button type="submit" class="pull-right pure-button pure-button-primary" ng-click="create_order()">Buy BTC</button>
                </div>
            </fieldset>
        </form>
        <hr />
          <div class="pure-g ">
            <div class="pure-u-1-2 order-table-containers">
              <div class='order-table-container'>
                <h3>Bids</h3>
                <div class='page_buttons'>
                  <a class="pure-button pull-left" ng-click="prev_page('bids')">Prev</a>
                    {{bids_current_page + 1}}/{{bids_max_page + 1}}
                  <a class="pure-button pull-right" ng-click="next_page('bids')">Next</a>
                </div>
                <table class="pure-table">
                  <thead>
                      <tr>
                          <th>NZD Rate</th>                  
                          <th>BTC Amount</th>                  
                      </tr>
                  </thead>

                  <tbody>
                      <tr ng-repeat="bid in paged_bids">
                          <td>{{bid.rate | currency:'$' }}</td>
                          <td>{{bid.volume | number:8 }}
                            <a class='order_popup' ng-show="bid.orders.length > 1" data-tooltip data-tooltip-label="Orders" data-tooltip-message="{{bid.order_description}}">({{ bid.orders.length }})</a>

                          </td> 
                      </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="pure-u-1-2">
              <div class='order-table-container'>
                <h3>Ask</h3>
                <div class='page_buttons'>
                  <a class="pure-button pull-left" ng-click="prev_page('asks')">Prev</a>
                  {{asks_current_page + 1}} / {{asks_max_page + 1}}
                  <a class="pure-button pull-right" ng-click="next_page('asks')">Next</a>
                </div>
                <table class="pure-table">
                  <thead>
                      <tr>
                          <th>NZD Rate</th>                  
                          <th>BTC Amount</th>                  
                      </tr>
                  </thead>

                  <tbody>
                      <tr ng-repeat="ask in paged_asks">
                          <td>{{ask.rate  | currency:'$'}}</td>
                          <td>{{ask.volume | number:8 }} 
                            <a class='order_popup' ng-show="ask.orders.length > 1" data-tooltip data-tooltip-label="Orders" data-tooltip-message="{{ask.order_description}}">({{ ask.orders.length }})</a>

                          </td> 
                      </tr>
                  </tbody>
                </table>
              </div>
            </div>      
        </div>
      </div>
    </script>
    <script id="trade.html" type="text/ng-template">
      <div>
        Move trade form and copy orderbook to here.
      </div>
    </script>
    <script id="history.html" type="text/ng-template">
      <div>
        User trade history displayed here.
      </div>
    </script>
    <script id="settings.html" type="text/ng-template">
      <div class="content">
        <h2 class="content-subhead">Settings</h2>
        <form ng-submit="Authorize()" class="pure-form pure-form-aligned">
          <div class="pure-control-group">
            <label for="settings-username">Username:</label>
            <input type="text" id="settings-username" ng-model="username" placeholder="" />
          </div>
          <div class="pure-control-group">
            <label for="settings-key">API Key:</label>
            <input type="text" id="settings-key" ng-model="key" placeholder="" />
          </div>
          <div class="pure-control-group">
            <label for="settings-secret">Secret:</label>
            <input type="text" id="settings-secret" ng-model="secret" placeholder="" />
          </div>
          <div class="pure-controls">
            <button type="submit" class="pure-button pure-button-primary">Authorize</button>
          </div>
          <div ng-show="authError">
            Authorization error: {{ errorMessage }}
          </div>
          <div>
            Authorized: {{ authorized }}
          </div>
        </form>
      </div>
    </script>
    <script id="help.html" type="text/ng-template">
      <div>
        Help!
      </div>
    </script>
    <script id="about.html" type="text/ng-template">
      <div>
        About this project.
      </div>
    </script>

    <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/hmac-sha256.js"></script>
    <script src="scripts/min/scripts.min.js"></script>        
</body>
</html>
